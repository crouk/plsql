2005-12-16
---------------

1.ARIKETA
--------------
CREATE OR REPLACE PROCEDURE IGO_SOLDATA
AS
	CURSOR C IS
		SELECT EMPNO,JOB,SAL FROM EMP;
	L C%ROWTYPE;
	SOLDATA EMP.SAL%TYPE;
	GEHITU NUMBER(8,2);
BEGIN
OPEN C;
FETCH C INTO L;
WHILE C%FOUND LOOP
	SELECT AVG(SAL) INTO SOLDATA FROM EMP WHERE JOB=L.JOB;
	IF (SOLDATA>L.SAL) THEN
		GEHITU:=(SOLDATA-L.SAL)*0.1;
		UPDATE EMP SET SAL=SAL+GEHITU WHERE EMPNO=L.EMPNO;
	END IF;
FETCH C INTO L;
END LOOP;
CLOSE C;
END;
/

2.ARIKETA
----------

CREATE OR REPLACE PROCEDURE KUADRADOS
AS
	CURSOR C IS
		SELECT ORDID,TOTAL FROM ORD;
	KONT NUMBER(2);
	TOTALA ORD.TOTAL%TYPE;
BEGIN
KONT:=0;
	FOR I UN C LOOP
		SELECT SUM(ITEMTOT) INTO TOTALA FROMM ITEM I, ORD O
		WHERE O.ORDID=I.ORDID
		AND O.ORDID=I.ORDID;
		
		IF TOTALA=I.TOTAL THEN
			KONT:=KONT+1;
		END IF;
	END LOOP;
	
	DBMS_OUTPUT.PUT_LINE(KONT);
END;
/

3.ARIKETA
----------

CREATE OR REPALCE TRIGGER
AFTER INSERT OR UPDATE OR DELETE
ON ITEM
FOR EACH ROW
BEGIN
	IF INSERTING THEN
		UPDATE ORD SET TOTAL=TOTAL+:NEW.ITEMTOT WHERE ORDID=:NEW.ORDID;
	IF UPDATING('ITEMTOT') THEN
		UPDATE ORD SET TOTAL=
END;
/